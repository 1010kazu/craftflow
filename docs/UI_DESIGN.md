# UI/UX設計書

## 1. 画面構成

### 1.1 ログイン画面
- メールアドレス入力
- パスワード入力
- ログインボタン
- 新規登録リンク

### 1.2 ゲーム選択画面
- ゲーム一覧（カード形式）
- 各ゲームカードに名前と説明を表示
- クリックでアイテム一覧へ遷移

### 1.3 アイテム一覧画面

#### レイアウト
```
┌─────────────────────────────────────────┐
│ ヘッダー（ゲーム名、戻るボタン）          │
├─────────────────────────────────────────┤
│ 検索バー [検索...]                       │
│ ソート: [名前順 ↑↓]                      │
├─────────────────────────────────────────┤
│ ┌─────┐ ┌─────┐ ┌─────┐                │
│ │アイテム│ │アイテム│ │アイテム│            │
│ │カード │ │カード │ │カード │            │
│ └─────┘ └─────┘ └─────┘                │
│ ...                                     │
├─────────────────────────────────────────┤
│ ページネーション                         │
└─────────────────────────────────────────┘
```

#### アイテムカード
- アイテム名
- アイテム種別バッジ（施設/素材/その他）
- クリックで詳細画面へ遷移

### 1.4 アイテム詳細画面

#### レイアウト
```
┌─────────────────────────────────────────┐
│ ヘッダー（アイテム名、戻るボタン）        │
├─────────────────────────────────────────┤
│ アイテム情報                             │
│ - 名前: 鉄板                             │
│ - 種別: 素材                             │
├─────────────────────────────────────────┤
│ レシピ情報                               │
│ - 作成時間: 60秒                         │
│ - 作成個数: 1個                          │
│ - 必要施設: 製錬所                       │
│ - 必要素材:                              │
│   • 鉄鉱石 × 2                           │
│                                          │
│ [レシピツリーを表示] ボタン              │
├─────────────────────────────────────────┤
│ レシピツリー（展開時）                    │
│ ┌─────────────────────────────────────┐ │
│ │ ▼ 鉄板 (必要数: 1)                   │ │
│ │   ├─ 鉄鉱石 × 2                      │ │
│ │   └─ ▼ 鉄鉱石 (必要数: 2)            │ │
│ │       └─ ...                         │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ 必要数合計:                              │
│ • 鉄鉱石: 2個                            │
│ • 銅鉱石: 1個                            │
└─────────────────────────────────────────┘
```

#### レシピツリー表示

##### ツリーノード構造
```
┌─────────────────────────────────────┐
│ ▼ アイテム名 (必要数: X)  [非表示]  │
│   ├─ 素材1 × 数量                    │
│   ├─ 素材2 × 数量                    │
│   └─ ▼ 子アイテム (必要数: Y) [非表示]│
│       └─ ...                         │
└─────────────────────────────────────┘
```

##### 展開/折りたたみ
- `▼` アイコン: 展開中
- `▶` アイコン: 折りたたみ中
- クリックで展開/折りたたみ切り替え
- 「非表示」ボタンでそのノード以下を非表示

##### 必要数計算
- 各ノードに「必要数」を表示
- 親の必要数 × レシピの必要数 = 子の必要数
- 同じアイテムが複数箇所で使用される場合は合算
- ツリー下部に全アイテムの必要数合計を表示

### 1.5 管理者画面

#### ゲーム管理画面
- ゲーム一覧
- 「新規追加」ボタン
- 各ゲームに「編集」「削除」ボタン

#### ゲーム追加/編集フォーム
- ゲーム名（必須）
- 説明（任意）
- 保存/キャンセルボタン

#### アイテム管理画面
- アイテム一覧
- 「新規追加」ボタン
- 「CSV/JSONインポート」ボタン
- 各アイテムに「編集」「削除」ボタン

#### アイテム追加/編集フォーム
```
┌─────────────────────────────────────────┐
│ アイテム情報                             │
│ - アイテム名: [入力]                     │
│ - アイテム種別: [選択]                   │
│   • 施設                                  │
│   • 素材                                  │
│   • その他                                │
├─────────────────────────────────────────┤
│ レシピ情報                               │
│ - 作成時間(秒): [入力]                   │
│ - 作成個数: [入力]                       │
│ - 必要施設: [選択]                       │
│   （アイテム種別=施設のアイテムのみ）     │
│                                          │
│ 必要素材:                                │
│ ┌─────────────────────────────────────┐ │
│ │ 素材アイテム: [選択] 数量: [入力]    │ │
│ │ [削除]                              │ │
│ └─────────────────────────────────────┘ │
│ [素材を追加]                             │
├─────────────────────────────────────────┤
│ [保存] [キャンセル]                      │
└─────────────────────────────────────────┘
```

#### インポートダイアログ
```
┌─────────────────────────────────────────┐
│ CSV/JSONインポート                       │
├─────────────────────────────────────────┤
│ ファイル形式: [CSV ▼] [JSON ▼]          │
│                                          │
│ [ファイルを選択]                         │
│                                          │
│ プレビュー:                              │
│ ┌─────────────────────────────────────┐ │
│ │ アイテム1, 60, 施設, MATERIAL, 1... │ │
│ │ アイテム2, 30, null, MATERIAL, 1... │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ [インポート] [キャンセル]                │
└─────────────────────────────────────────┘
```

## 2. コンポーネント詳細

### 2.1 RecipeTree コンポーネント

```typescript
interface RecipeTreeProps {
  itemId: string;
  initialQuantity?: number;
}

// ツリーノードの状態管理
interface TreeNodeState {
  isExpanded: boolean;
  isVisible: boolean;
}
```

**機能:**
- 再帰的にレシピツリーを表示
- 各ノードの展開/折りたたみ
- 各ノードの非表示/表示
- 必要数の計算と表示

### 2.2 MaterialSummary コンポーネント

```typescript
interface MaterialSummaryProps {
  tree: RecipeTreeNode;
}
```

**機能:**
- ツリー全体から必要数を集計
- アイテムごとの必要数合計を表示
- ソート機能（名前順、数量順）

### 2.3 ImportDialog コンポーネント

**機能:**
- ファイル選択
- CSV/JSON形式の選択
- プレビュー表示
- バリデーションエラー表示
- インポート実行

## 3. レスポンシブデザイン

### 3.1 ブレークポイント
- Mobile: < 768px
- Tablet: 768px - 1024px
- Desktop: > 1024px

### 3.2 モバイル対応
- アイテム一覧: 1列表示
- レシピツリー: 横スクロール可能
- フォーム: 縦並びレイアウト

## 4. アクセシビリティ

### 4.1 キーボード操作
- Tab: フォーカス移動
- Enter: ボタン実行
- Space: 展開/折りたたみ

### 4.2 ARIA属性
- `aria-label`: ボタンの説明
- `aria-expanded`: 展開状態
- `role`: 適切なロール設定

## 5. パフォーマンス

### 5.1 仮想スクロール
- 大量アイテム対応（react-window使用）

### 5.2 メモ化
- React.memo: コンポーネントの再レンダリング最適化
- useMemo: 計算結果のキャッシュ

### 5.3 遅延読み込み
- レシピツリーの子ノードは必要時に読み込み

## 6. エラーハンドリング

### 6.1 エラー表示
- トースト通知（成功/エラー）
- インラインエラー（フォーム）

### 6.2 ローディング状態
- スケルトンローディング
- プログレスバー

## 7. カラーパレット（推奨）

```css
/* プライマリカラー */
--primary: #1976d2;
--primary-dark: #1565c0;
--primary-light: #42a5f5;

/* セカンダリカラー */
--secondary: #dc004e;
--secondary-dark: #c51162;
--secondary-light: #f50057;

/* 背景色 */
--background: #ffffff;
--surface: #f5f5f5;

/* テキスト */
--text-primary: #212121;
--text-secondary: #757575;

/* アイテム種別 */
--facility: #4caf50;
--material: #ff9800;
--other: #9e9e9e;
```
